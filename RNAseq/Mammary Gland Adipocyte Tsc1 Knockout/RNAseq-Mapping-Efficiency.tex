\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Calculation of Mapping for RNAseq samples},
            pdfauthor={Dave Bridges},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{longtable}}{}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Calculation of Mapping for RNAseq samples}
\author{Dave Bridges}
\date{April 2, 2021}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{purpose}{%
\section{Purpose}\label{purpose}}

To calculate amount of mapping for each sample

\hypertarget{experimental-details}{%
\section{Experimental Details}\label{experimental-details}}

Ran samples through salmon, this script analyzes their log files

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quant.directories <-}\StringTok{ 'quants'}
\NormalTok{sample.directories <-}\StringTok{ }\KeywordTok{list.dirs}\NormalTok{(quant.directories, }
                                \DataTypeTok{recursive=}\NormalTok{F) }\CommentTok{#identify directories that contain salmon output}
\NormalTok{sample.directories <-}\StringTok{ }\NormalTok{sample.directories[}\KeywordTok{grepl}\NormalTok{(}\StringTok{'NEH'}\NormalTok{, sample.directories)] }\CommentTok{#only noura samples}
\NormalTok{log.files <-}\StringTok{ }\KeywordTok{file.path}\NormalTok{(sample.directories,}\StringTok{"aux_info/meta_info.json"}\NormalTok{) }\CommentTok{#locate meta_info files for each directory}
\NormalTok{log.files <-}\StringTok{ }\NormalTok{log.files[}\KeywordTok{file.exists}\NormalTok{(log.files)]}

\NormalTok{file <-}\StringTok{ }\NormalTok{log.files[}\DecValTok{1}\NormalTok{]}
\KeywordTok{library}\NormalTok{(jsonlite)}
\NormalTok{mapping.data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
\NormalTok{mapping.data <-}\StringTok{ }\KeywordTok{setNames}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{ncol =} \DecValTok{4}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{0}\NormalTok{)), }\KeywordTok{c}\NormalTok{(}\StringTok{"file"}\NormalTok{, }\StringTok{"processed"}\NormalTok{, }\StringTok{"mapped"}\NormalTok{, }\StringTok{"percent.mapped"}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{file=}\KeywordTok{as.character}\NormalTok{(),}
         \DataTypeTok{processed=}\KeywordTok{as.integer}\NormalTok{(),}
         \DataTypeTok{mapped=}\KeywordTok{as.integer}\NormalTok{(),}
         \DataTypeTok{percent.mapped=}\KeywordTok{as.numeric}\NormalTok{())}

\ControlFlowTok{for}\NormalTok{ (file }\ControlFlowTok{in}\NormalTok{ log.files) \{}
\NormalTok{  data <-}\StringTok{ }\KeywordTok{fromJSON}\NormalTok{(file)}
\NormalTok{  mapping.data <-}\StringTok{ }\KeywordTok{add_row}\NormalTok{(mapping.data, }
                        \DataTypeTok{file=}\NormalTok{file, }
                        \DataTypeTok{processed=}\NormalTok{data}\OperatorTok{$}\NormalTok{num_processed, }
                        \DataTypeTok{mapped=}\NormalTok{data}\OperatorTok{$}\NormalTok{num_mapped, }
                        \DataTypeTok{percent.mapped=}\NormalTok{data}\OperatorTok{$}\NormalTok{percent_mapped)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{summary-of-mapping}{%
\section{Summary of Mapping}\label{summary-of-mapping}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mapping.data }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{separate}\NormalTok{(file, }\DataTypeTok{into=}\KeywordTok{c}\NormalTok{(}\StringTok{'Folder'}\NormalTok{,}\StringTok{'Sample'}\NormalTok{,}\StringTok{'Aux'}\NormalTok{,}\StringTok{'Meta'}\NormalTok{), }\DataTypeTok{sep=}\StringTok{"/"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{Folder,}\OperatorTok{-}\NormalTok{Aux,}\OperatorTok{-}\NormalTok{Meta) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable}\NormalTok{(}\DataTypeTok{caption=}\StringTok{"Sample level mapping results"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrr@{}}
\caption{Sample level mapping results}\tabularnewline
\toprule
Sample & processed & mapped & percent.mapped\tabularnewline
\midrule
\endfirsthead
\toprule
Sample & processed & mapped & percent.mapped\tabularnewline
\midrule
\endhead
NEH-Sample\_1415-NEH-1\_quant & 68797630 & 36919689 &
53.7\tabularnewline
NEH-Sample\_1415-NEH-10\_quant & 53074920 & 29967599 &
56.5\tabularnewline
NEH-Sample\_1415-NEH-11\_quant & 60844806 & 33393597 &
54.9\tabularnewline
NEH-Sample\_1415-NEH-2\_quant & 60837388 & 33004083 &
54.2\tabularnewline
NEH-Sample\_1415-NEH-3\_quant & 46190369 & 25817975 &
55.9\tabularnewline
NEH-Sample\_1415-NEH-4\_quant & 46879516 & 26061239 &
55.6\tabularnewline
NEH-Sample\_1415-NEH-5\_quant & 56732424 & 30472454 &
53.7\tabularnewline
NEH-Sample\_1415-NEH-6\_quant & 69409104 & 37894237 &
54.6\tabularnewline
NEH-Sample\_1415-NEH-7\_quant & 60796832 & 34385159 &
56.6\tabularnewline
NEH-Sample\_1415-NEH-8\_quant & 56688381 & 30427723 &
53.7\tabularnewline
NEH-Sample\_1415-NEH-9\_quant & 50846057 & 26973283 &
53.0\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mapping.data }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{select}\NormalTok{(}\OperatorTok{-}\NormalTok{file) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{summarize_all}\NormalTok{(}\DataTypeTok{.funs=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{Average=}\NormalTok{mean,}\DataTypeTok{Min=}\NormalTok{min,}\DataTypeTok{Max=}\NormalTok{max)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\KeywordTok{everything}\NormalTok{(), }\DataTypeTok{names_sep=}\StringTok{"_"}\NormalTok{, }\DataTypeTok{names_to=}\KeywordTok{c}\NormalTok{(}\StringTok{'Measure'}\NormalTok{,}\StringTok{'Stat'}\NormalTok{)) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_wider}\NormalTok{(}\KeywordTok{everything}\NormalTok{(), }\DataTypeTok{names_from=}\StringTok{'Stat'}\NormalTok{, }\DataTypeTok{values_from=}\StringTok{'value'}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{kable}\NormalTok{(}\DataTypeTok{caption=}\StringTok{"Summary statistics for salmon mapping."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lrrr@{}}
\caption{Summary statistics for salmon mapping.}\tabularnewline
\toprule
Measure & Average & Min & Max\tabularnewline
\midrule
\endfirsthead
\toprule
Measure & Average & Min & Max\tabularnewline
\midrule
\endhead
processed & 57372493.4 & 46190369 & 69409104.0\tabularnewline
mapped & 31392458.0 & 25817975 & 37894237.0\tabularnewline
percent.mapped & 54.8 & 53 & 56.6\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{session-information}{%
\section{Session Information}\label{session-information}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 4.0.2 (2020-06-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS  10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] jsonlite_1.7.2 dplyr_1.0.5    tidyr_1.1.3    knitr_1.31    
## 
## loaded via a namespace (and not attached):
##  [1] magrittr_2.0.1    tidyselect_1.1.0  R6_2.5.0          rlang_0.4.10     
##  [5] fansi_0.4.2       highr_0.8         stringr_1.4.0     tools_4.0.2      
##  [9] xfun_0.22         utf8_1.2.1        DBI_1.1.1         htmltools_0.5.1.1
## [13] ellipsis_0.3.1    assertthat_0.2.1  yaml_2.2.1        digest_0.6.27    
## [17] tibble_3.1.0      lifecycle_1.0.0   crayon_1.4.1      purrr_0.3.4      
## [21] vctrs_0.3.7       glue_1.4.2        evaluate_0.14     rmarkdown_2.7    
## [25] stringi_1.5.3     compiler_4.0.2    pillar_1.5.1      generics_0.1.0   
## [29] pkgconfig_2.0.3
\end{verbatim}

\end{document}
